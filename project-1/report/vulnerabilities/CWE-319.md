<div align="center">
    <h1>CWE-319</h1>
    <i>
        Cleartext Transmission of Sensitive Information
    </i>
</div>

<br>

## Description

Sensitive information is sent in clear text over the network.

<br>

## Exploit
Since the network connection is not secure (HTTP), information can be intercepted by anyone with access to the network ([packet sniffing](https://en.wikipedia.org/wiki/Sniffing_attack)).

To do so, **wireshark** can be used to capture packets corresponding to api requests, as shown bellow:

<br>

![](/analysis/CWE-319/insecure_connection.gif)

<br>

## Consequences
Sensitive information, such as codes, names, emails, phone numbers, and messages can be read by someone looking at the packets sent. 

It is an extremely worrying situation in a public website, especially due to the low effort required to perform such an attack.

<br>

## Mitigation
To solve this, it is required to use a different protocol to send and receive information (**HTTPS**).

HTTPS uses **SSL/TLS**, which encrypts the data using a short-term private key (renewed frequently), generated by a long-term private and public key pair.

The creation of such keys depends on a **private key**, used to generate a **certificate**.

Following [CherryPy Docs](https://docs.cherrypy.dev/en/latest/deploy.html#ssl-support), both private key and certificate were created using **OpenSSL**.
Then, in the server configurations, we enabled the SSL connection, referencing both cert and priv key.

After restarting the server, **a secure connection was established!**


Since our certificate is self-signed, the browser won't be able to verify its authenticity, hence a warning showing when the website is open.

After checking the contents of the network packages, we can safely say that the connection is encrypted:

<br>

![](/analysis/CWE-319/secure_connection.gif)

---

<div align="center">
<i>
    <a href="/report/README.md">Back to report</a>
</i>
</div>
